<DOCTYPE HTML>
<html>
  <head>
    <title>TipTopAPI</title>
  </head>
  <body>
    <div id="tt_main">
      <p>"Hello, this is a test of the TipTop API call using Javascript and XHR"</p>
    </div>
    <script>
      /*
      Origin : "http://apis.feeltiptop.com/demos/Restler/twitterdemo/tweet/analyze?tweet=Chilly%20on%20the%20first%20day%20of%20summer%20in%20the%20bay%20area"
      var url = "http://apis.feeltiptop.com/demos/Restler/twitterdemo/tweet/analyze?tweet=Chilly%20on%20the%20first%20day%20of%20summer%20in%20the%20bay%20area"
      */
      var xhr=new XMLHttpRequest();

      console.log("created a xmlhhtprequest object");
      xhr.open("GET","tiptop_twitterapi.php",true);
      xhr.setRequestHeader("Content-Type", "application/json");

      xhr.send();

      console.log("Status", xhr.status);
      console.log("Status text", xhr.statusText);

      xhr.onreadystatechange = function()
      {
        if (xhr.readyState != 4)
        {
          console.log(xhr.readyState);
          return; // Not there yet
        }
        if (xhr.status != 200)
        {
          // Handle request failure here...
          console.log(xhr.readyState);
          return;
        }
        // Request successful, read the response
        var resp = xhr.responseText;
        console.log(resp);
        // ... and use it as needed by your app.
        var noob = JSON.parse(resp);
        //var json = '{"bayarea": "50", "tweet": "Chilly on the first day of summer in the bay area"}'
        //var json = '{"items" : [{"tweet" : "Obama is the president of the United States", "topic" : [ {"Obama" : "50"}, {"President" : "100"} ] }, {"tweet" : "Chilly in the Bay Area", "topic" : [ {"BayArea" : "50"}, {"Weather" : "100"} ] }]}'
        //var noob = JSON.parse(json);
        //document.getElementById("tweet").innerHTML = noob.items[1].topic[1].Weather;
        console.log(noob.topics.length);
        var count=0;
        var table = "<table style=\"width:100%\">"

        table += "<tr><td>" + noob.tweet + "</td>";

        for (count=0; count<noob.topics.length; count++)
        {
          //table += "<tr><td>" + noob.items[count].tweet + "</td>";
          //for (count1=0; count1<noob.items[count].topic.length; count1++)
            for (var propertyName in noob.topics[count])
            {
              table += "<td>" + propertyName + ":" + noob.topics[count][propertyName] + "</td>";
            }
        }
          table += "</tr>";
          //document.getElementById("tweets").innerHTML = myRows;
          //document.getElementById("tt_main").innerHTML = myHTML;
        table += "</table>";
        document.getElementById("tt_main").innerHTML = table;
        console.log("json")
      }
    </script>
  </body>

</html>
